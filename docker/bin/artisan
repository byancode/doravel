#!/bin/ash

if [ ! -f /usr/local/bin/php-cli ]; then
    gum log --time rfc822 --level fatal "No has instalado PHP"
    # TODO - aqui debe hacer informacion de como usar el comando builder para instalar PHP
    exit 1
fi

if [ ! -f /usr/local/bin/composer ]; then
    gum log --time rfc822 --level fatal "No has instalado Composer"
    # TODO - aqui debe hacer informacion de como usar el comando builder para instalar Composer
    exit 1
fi

if [ ! -d "./vendor" ]; then
    composer install
fi

APP_ENV=${APP_ENV:-'local'}
COMMAND="/usr/local/bin/php /var/www/artisan"

if [ "$APP_ENV" == "local" ]; then
    $COMMAND $@
else
    $COMMAND --env="$APP_ENV" $@
fi