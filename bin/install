#!/bin/bash


DISTRO=$(cat /etc/os-release | grep "^ID=" | cut -d= -f2)
DISTRO=${DISTRO//\"/}

# check if curl is installed and if not, install it
if ! [ -x "$(command -v curl)" ]; then
    if  [ "$DISTRO" == "ubuntu" ] || [ "$DISTRO" == "debian" ]; then
        sudo apt-get update
        sudo apt-get install curl -y
    elif [ "$DISTRO" == "centos" ] || [ "$DISTRO" == "rhel" ]; then
        sudo yum update
        sudo yum install curl -y
    elif [ "$DISTRO" == "arch" ] || [ "$DISTRO" == "arcolinux" ]; then
        sudo pacman -Syu
        sudo pacman -S curl -y
    fi
fi

if ! [ -x "$(command -v docker)" ]; then
    if [ "$DISTRO" == "arch" ] || [ "$DISTRO" == "arcolinux" ]; then
        sudo pacman -Syu
        sudo pacman -S docker -y
    else
        curl https://get.docker.com | bash
    fi
fi

ENDPOINT="https://raw.githubusercontent.com/byancode/doravel/main"

if [ ! -d ~/bin ]; then
    mkdir ~/bin
fi

curl $ENDPOINT/bin/doravel -o ~/bin/doravel
curl $ENDPOINT/bin/dlocal -o ~/bin/dlocal
curl $ENDPOINT/bin/dtest -o ~/bin/dtest
curl $ENDPOINT/bin/dprod -o ~/bin/dprod

chmod +x ~/bin/doravel
chmod +x ~/bin/dlocal
chmod +x ~/bin/dtest
chmod +x ~/bin/dprod

ln -sf ~/bin/doravel ~/bin/dv

source ~/.bashrc